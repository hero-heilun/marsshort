# marsshort
ç«æ˜ŸçŸ­å‰§
# çŸ­å‰§å¨±ä¹å¹³å° - å¤šå†…å®¹ç±»å‹å¨±ä¹å¹³å°

## ğŸ¬ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªç»¼åˆæ€§å¨±ä¹å¹³å°ï¼Œæ”¯æŒ**çŸ­å‰§ã€å°è¯´ã€æ¼«ç”»ã€å¬ä¹¦**å››ç§ä¸»è¦å†…å®¹ç±»å‹ã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼ŒFlutterç§»åŠ¨ç«¯ + Spring Bootå¾®æœåŠ¡åç«¯ + ç®¡ç†åå°çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## é¡¹ç›®æ¶æ„

### æŠ€æœ¯æ ˆ
- **åç«¯**: Spring Boot + Spring Cloud Gateway + MySQL + Redis + RabbitMQ + MinIO + Elasticsearch
- **å‰ç«¯**: Vue 3 + TypeScript + Ant Design Vue (ç®¡ç†åå°)
- **ç§»åŠ¨ç«¯**: Flutter + GetX (å®¢æˆ·ç«¯åº”ç”¨)
- **éƒ¨ç½²**: Docker + Docker Compose + Nginx

### ç³»ç»Ÿæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Flutter App   â”‚    â”‚   Vue3 Admin    â”‚    â”‚   Mobile Web    â”‚
â”‚    (ç§»åŠ¨ç«¯)      â”‚    â”‚   (ç®¡ç†åå°)     â”‚    â”‚   (Webç«¯)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      Nginx      â”‚
                    â”‚   (åå‘ä»£ç†)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  API Gateway    â”‚
                    â”‚   (Spring CLoud) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Service   â”‚    â”‚ Content Service â”‚    â”‚ Payment Service â”‚
â”‚   (ç”¨æˆ·æœåŠ¡)     â”‚    â”‚   (å†…å®¹æœåŠ¡)     â”‚    â”‚   (æ”¯ä»˜æœåŠ¡)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚              â”‚Notification Svc â”‚              â”‚
         â”‚              â”‚   (é€šçŸ¥æœåŠ¡)     â”‚              â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    åŸºç¡€è®¾æ–½å±‚                            â”‚
    â”‚  MySQL  â”‚  Redis  â”‚ RabbitMQ â”‚  MinIO  â”‚ Elasticsearch  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½æ¨¡å—

### ç”¨æˆ·ç«¯åŠŸèƒ½
- âœ… ç”¨æˆ·æ³¨å†Œ/ç™»å½•/æ‰¾å›å¯†ç 
- âœ… ä¸ªäººèµ„æ–™ç®¡ç†
- âœ… è§†é¢‘æ’­æ”¾/ç‚¹èµ/è¯„è®º/åˆ†äº«
- âœ… å…³æ³¨/ç²‰ä¸ç³»ç»Ÿ
- âœ… é’»çŸ³å……å€¼/æ¶ˆè´¹
- âœ… è§‚çœ‹å†å²è®°å½•
- âœ… æ¨é€é€šçŸ¥

### ç®¡ç†ç«¯åŠŸèƒ½
- âœ… ç”¨æˆ·ç®¡ç†å’Œæƒé™æ§åˆ¶
- âœ… å†…å®¹å®¡æ ¸å’Œç®¡ç†
- âœ… è´¢åŠ¡æ•°æ®ç»Ÿè®¡
- âœ… ç³»ç»Ÿé…ç½®ç®¡ç†
- âœ… æ•°æ®åˆ†ææŠ¥è¡¨
- âœ… æ—¥å¿—ç›‘æ§

### æ ¸å¿ƒä¸šåŠ¡
- âœ… å‰§é›†/è§†é¢‘ç®¡ç†
- âœ… åˆ†ç±»æ ‡ç­¾ç³»ç»Ÿ
- âœ… è¯„è®ºäº’åŠ¨ç³»ç»Ÿ
- âœ… é’»çŸ³ç»æµç³»ç»Ÿ
- âœ… VIPä¼šå‘˜ç³»ç»Ÿ
- âœ… æœç´¢æ¨èç³»ç»Ÿ

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Docker >= 20.0
- Docker Compose >= 2.0
- Git
- Node.js >= 16 (å¼€å‘ç¯å¢ƒ)
- Flutter SDK >= 3.0 (å¼€å‘ç¯å¢ƒ)
- Java 17+ (å¼€å‘ç¯å¢ƒ)

### ä¸€é”®éƒ¨ç½²
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd shortVideo

# æ‰§è¡Œéƒ¨ç½²è„šæœ¬
./scripts/deploy.sh install
```

### æ‰‹åŠ¨éƒ¨ç½²

1. **å¯åŠ¨åŸºç¡€æœåŠ¡**
```bash
docker-compose up -d mysql redis rabbitmq minio elasticsearch
```

2. **æ„å»ºåº”ç”¨æœåŠ¡**
```bash
# æ„å»ºåç«¯æœåŠ¡
./scripts/deploy.sh build_backend

# æ„å»ºå‰ç«¯åº”ç”¨
./scripts/deploy.sh build_frontend
```

3. **å¯åŠ¨æ‰€æœ‰æœåŠ¡**
```bash
docker-compose up -d
```

4. **åˆå§‹åŒ–æ•°æ®**
```bash
# æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–
docker-compose exec mysql mysql -uroot -proot123456 < scripts/init.sql
```

## è®¿é—®åœ°å€

### å‰ç«¯åº”ç”¨
- ğŸŒ **ç§»åŠ¨ç«¯åº”ç”¨**: https://localhost/app
- ğŸ› ï¸ **ç®¡ç†åå°**: https://localhost/admin
- ğŸ“– **APIæ–‡æ¡£**: https://localhost/api/swagger-ui

### ç®¡ç†ç•Œé¢
- ğŸ“¦ **MinIOæ§åˆ¶å°**: http://localhost:9001
- ğŸ° **RabbitMQç®¡ç†**: http://localhost:15672
- ğŸ” **Elasticsearch**: http://localhost:9200

### é»˜è®¤è´¦å·

#### ç®¡ç†åå°
| è§’è‰² | ç”¨æˆ·å | å¯†ç  | æƒé™ |
|------|--------|------|------|
| è¶…çº§ç®¡ç†å‘˜ | admin | admin123 | å…¨éƒ¨æƒé™ |
| å†…å®¹ç®¡ç†å‘˜ | content | content123 | å†…å®¹ç®¡ç† |
| è´¢åŠ¡ç®¡ç†å‘˜ | finance | finance123 | è´¢åŠ¡ç®¡ç† |

#### åŸºç¡€æœåŠ¡
| æœåŠ¡ | ç”¨æˆ·å | å¯†ç  |
|------|--------|------|
| MySQL | root | root123456 |
| Redis | - | redis123456 |
| MinIO | minioadmin | minioadmin123 |
| RabbitMQ | admin | admin123456 |

## å¼€å‘æŒ‡å—

### åç«¯å¼€å‘

#### é¡¹ç›®ç»“æ„
```
backend/
â”œâ”€â”€ api-gateway/          # APIç½‘å…³
â”œâ”€â”€ user-service/         # ç”¨æˆ·æœåŠ¡
â”œâ”€â”€ content-service/      # å†…å®¹æœåŠ¡
â”œâ”€â”€ payment-service/      # æ”¯ä»˜æœåŠ¡
â””â”€â”€ notification-service/ # é€šçŸ¥æœåŠ¡
```

#### æœ¬åœ°å¼€å‘
```bash
# å¯åŠ¨åŸºç¡€æœåŠ¡
docker-compose up -d mysql redis rabbitmq

# å¯åŠ¨å¾®æœåŠ¡ï¼ˆåœ¨å„æœåŠ¡ç›®å½•ä¸‹ï¼‰
./mvnw spring-boot:run
```

### å‰ç«¯å¼€å‘

#### ç®¡ç†åå°
```bash
cd admin
npm install
npm run dev      # å¼€å‘ç¯å¢ƒ
npm run build    # ç”Ÿäº§æ„å»º
```

#### Flutteråº”ç”¨
```bash
cd flutter
flutter pub get
flutter run      # å¼€å‘è¿è¡Œ
flutter build web # Webæ„å»º
```

## éƒ¨ç½²è¿ç»´

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./scripts/deploy.sh logs [service-name]

# å¤‡ä»½æ•°æ®
./scripts/deploy.sh backup

# æ¢å¤æ•°æ®
./scripts/deploy.sh restore backup.tar.gz

# æ›´æ–°æœåŠ¡
./scripts/deploy.sh update

# é‡å¯æœåŠ¡
./scripts/deploy.sh restart

# åœæ­¢æœåŠ¡
./scripts/deploy.sh stop

# æ¸…ç†æ•°æ®
./scripts/deploy.sh cleanup
```

### ç›‘æ§å‘Šè­¦
é¡¹ç›®é›†æˆäº†ä»¥ä¸‹ç›‘æ§åŠŸèƒ½ï¼š
- Spring Boot Actuator å¥åº·æ£€æŸ¥
- åº”ç”¨æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- é”™è¯¯æ—¥å¿—èšåˆ
- ç³»ç»Ÿèµ„æºç›‘æ§

### æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®åº“ä¼˜åŒ–
- ä½¿ç”¨è¿æ¥æ± ä¼˜åŒ–æ•°æ®åº“è¿æ¥
- åˆç†è®¾è®¡ç´¢å¼•æå‡æŸ¥è¯¢æ€§èƒ½
- è¯»å†™åˆ†ç¦»æ”¯æŒé«˜å¹¶å‘
- å®šæœŸæ¸…ç†å†å²æ•°æ®

#### ç¼“å­˜ç­–ç•¥
- Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- CDNåŠ é€Ÿé™æ€èµ„æº
- æµè§ˆå™¨ç¼“å­˜ä¼˜åŒ–
- æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜

#### æœåŠ¡ä¼˜åŒ–
- å¾®æœåŠ¡æ°´å¹³æ‰©å±•
- è´Ÿè½½å‡è¡¡åˆ†å‘è¯·æ±‚
- å¼‚æ­¥æ¶ˆæ¯å¤„ç†
- é™æµç†”æ–­ä¿æŠ¤

## APIæ–‡æ¡£

### ç”¨æˆ·ç›¸å…³æ¥å£
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/user/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /api/user/profile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### å†…å®¹ç›¸å…³æ¥å£
- `GET /api/videos` - è·å–è§†é¢‘åˆ—è¡¨
- `GET /api/videos/{id}` - è·å–è§†é¢‘è¯¦æƒ…
- `POST /api/videos/{id}/like` - ç‚¹èµè§†é¢‘
- `POST /api/videos/{id}/comments` - æ·»åŠ è¯„è®º

### æ”¯ä»˜ç›¸å…³æ¥å£
- `GET /api/diamonds/packages` - è·å–é’»çŸ³å¥—é¤
- `POST /api/orders` - åˆ›å»ºè®¢å•
- `GET /api/orders/{id}` - æŸ¥è¯¢è®¢å•çŠ¶æ€

æ›´å¤šAPIè¯¦æƒ…è¯·æŸ¥çœ‹åœ¨çº¿æ–‡æ¡£ï¼šhttps://localhost/api/swagger-ui

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„
- `users` - ç”¨æˆ·è¡¨
- `dramas` - å‰§é›†è¡¨
- `videos` - è§†é¢‘è¡¨
- `categories` - åˆ†ç±»è¡¨
- `comments` - è¯„è®ºè¡¨
- `likes` - ç‚¹èµè¡¨
- `orders` - è®¢å•è¡¨
- `diamond_packages` - é’»çŸ³å¥—é¤è¡¨

è¯¦ç»†çš„æ•°æ®åº“è®¾è®¡è¯·å‚è€ƒ `scripts/init.sql`

## å®‰å…¨é…ç½®

### æ•°æ®å®‰å…¨
- JWT Tokenè®¤è¯
- å¯†ç BCryptåŠ å¯†
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤
- CSRFä¿æŠ¤

### ç½‘ç»œå®‰å…¨
- HTTPSå¼ºåˆ¶è·³è½¬
- å®‰å…¨å¤´é…ç½®
- é™æµé˜²åˆ·
- IPç™½åå•

## å¸¸è§é—®é¢˜

### Q: æœåŠ¡å¯åŠ¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: 
1. æ£€æŸ¥Dockeræ˜¯å¦æ­£å¸¸è¿è¡Œ
2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—å®šä½é—®é¢˜
3. ç¡®è®¤ç«¯å£æ˜¯å¦è¢«å ç”¨
4. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ
A:
1. ç¡®è®¤MySQLæœåŠ¡æ­£å¸¸å¯åŠ¨
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
3. éªŒè¯ç”¨æˆ·åå¯†ç æ­£ç¡®æ€§
4. ç¡®è®¤ç½‘ç»œè¿é€šæ€§

### Q: å‰ç«¯é¡µé¢æ— æ³•è®¿é—®ï¼Ÿ
A:
1. æ£€æŸ¥NginxæœåŠ¡çŠ¶æ€
2. éªŒè¯å‰ç«¯æ„å»ºæ˜¯å¦æˆåŠŸ
3. ç¡®è®¤åŸŸåè§£æé…ç½®
4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ”¹åŠ¨ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: https://github.com/your-repo/shortvideo
- é—®é¢˜åé¦ˆ: https://github.com/your-repo/shortvideo/issues
- æŠ€æœ¯æ–‡æ¡£: https://docs.shortvideo.com

---

**æ„Ÿè°¢ä½¿ç”¨çŸ­å‰§å¹³å°ï¼** ğŸ¬
